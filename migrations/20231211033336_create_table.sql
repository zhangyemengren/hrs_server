-- Add migration script here
CREATE TABLE companies
(
    id           INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    company_name varchar(255)
);

CREATE TABLE departments
(
    id              INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    department_name varchar(255)
);

CREATE TABLE modules
(
    id   INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    type varchar(255)
);
-- 子模块 modules从表
CREATE TABLE sub_modules
(
    id        INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    type      varchar(255),
    module_id INT,
    FOREIGN KEY (module_id) REFERENCES modules (id)
);
-- 关联表
CREATE TABLE permissions
(
    role_id       INT,
    module_id     INT,
    sub_module_id INT,
    PRIMARY KEY (role_id, module_id),
    FOREIGN KEY (role_id) REFERENCES roles (id),
    FOREIGN KEY (module_id) REFERENCES modules (id),
    FOREIGN KEY (sub_module_id) REFERENCES sub_modules (id)
);

CREATE TABLE roles
(
    id   INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    type varchar(255)
);

CREATE TABLE posts
(
    id   INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    type varchar(255)
);

CREATE TABLE stores
(
    id         INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    store_name varchar(255)
);

CREATE TABLE users
(
    id           INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name         varchar(255),
    email        varchar(255),
    phone        varchar(255),
    male         integer,
    birth        varchar(255),
    superior     integer,
    post         integer,
    company      integer,
    joining_date VARCHAR(255),
    department   integer,
    FOREIGN KEY (superior) REFERENCES users (id),
    FOREIGN KEY (post) REFERENCES posts (id),
    FOREIGN KEY (company) REFERENCES companies (id),
    FOREIGN KEY (department) REFERENCES departments (id)
);